<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mazellov Clicker - Stream Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Unbounded', sans-serif;
            background-color: #020617;
            color: #f8fafc;
            overflow: hidden;
            margin: 0;
            height: 100vh;
        }
        .click-btn:active {
            transform: scale(0.95);
        }
        .cooldown {
            filter: grayscale(1) blur(2px);
            pointer-events: none;
        }
        .floating-text {
            position: absolute;
            pointer-events: none;
            animation: floatUp 0.8s ease-out forwards;
            font-weight: 800;
            z-index: 100;
            text-shadow: 0 0 10px rgba(168, 85, 247, 0.5);
        }
        @keyframes floatUp {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-120px) scale(1.2); opacity: 0; }
        }
        .progress-bar {
            transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .avatar-container {
            position: relative;
            width: 220px;
            height: 220px;
        }
        .avatar-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
            border: 4px solid #a855f7;
            box-shadow: 0 0 30px rgba(168, 85, 247, 0.4);
            transition: all 0.5s ease;
        }
        .glow-effect {
            position: absolute;
            inset: -10px;
            background: radial-gradient(circle, rgba(168, 85, 247, 0.2) 0%, transparent 70%);
            border-radius: 50%;
            z-index: -1;
        }
        .upgrade-icon {
            width: 52px;
            height: 52px;
            border-radius: 10px;
            object-fit: cover;
            border: 2px solid #334155;
            background: #1e293b;
        }
        .donation-alert {
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translateX(-50%) scale(0.8);
            background: #ff7534;
            color: white;
            padding: 20px 40px;
            border-radius: 10px;
            box-shadow: 0 0 40px rgba(255, 117, 52, 0.5);
            z-index: 200;
            text-align: center;
            opacity: 0;
            pointer-events: none;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .donation-alert.active {
            opacity: 1;
            transform: translateX(-50%) scale(1);
        }
        .minigame-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .box-target {
            width: 200px;
            height: 200px;
            background: #4a3728;
            border: 4px dashed #7a5a41;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            margin-top: 50px;
        }
        .game-item {
            position: absolute;
            cursor: pointer;
            transition: transform 0.1s;
            font-size: 2.5rem;
            user-select: none;
        }
        .game-item:active { transform: scale(1.2); }

        .tab-btn.active {
            border-color: #a855f7;
            color: #a855f7;
            background: rgba(168, 85, 247, 0.1);
        }
    </style>
</head>
<body class="flex flex-col h-screen overflow-hidden">

    <audio id="bg-music" loop>
        <source src="https://www.dropbox.com/scl/fi/th9kidjdf1blqezgqlpcz/.mp3?rlkey=59a6wz4w09v35noavrwbiy081&st=zel497ne&dl=1" type="audio/mpeg">
    </audio>

    <!-- UI —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –¥–æ–Ω–∞—Ç–∞—Ö -->
    <div id="da-alert" class="donation-alert">
        <div class="font-black italic text-2xl mb-1 uppercase tracking-tighter">DonationAlerts</div>
        <div id="da-user" class="font-bold text-lg">–ó—Ä–∏—Ç–µ–ª—å_1337</div>
        <div id="da-amount" class="text-3xl font-black mt-2">500 ‚ÇΩ</div>
        <div id="da-msg" class="text-sm mt-2 opacity-90 italic">"–ù–∞ –±—Ä–∏—Ç—å–µ!"</div>
    </div>

    <!-- –ú–∏–Ω–∏-–∏–≥—Ä–∞ –ü–µ—Ä–µ–µ–∑–¥ -->
    <div id="minigame-screen" class="minigame-overlay">
        <h2 class="text-3xl font-black text-white mb-2 italic">–í–†–ï–ú–Ø –ü–ï–†–ï–ï–ó–î–ê!</h2>
        <p class="text-slate-400 mb-8">–£—Å–ø–µ–π —Å–æ–±—Ä–∞—Ç—å –≤—Å–µ –≤–µ—â–∏ –≤ –∫–æ—Ä–æ–±–∫—É!</p>
        <div id="minigame-timer" class="text-5xl font-black text-yellow-500 mb-4">10.0</div>
        
        <div id="game-area" class="relative w-full max-w-2xl h-[400px] border border-slate-800 bg-slate-900/50 rounded-3xl overflow-hidden">
            <div class="box-target mx-auto mt-20 rounded-lg">
                <span class="text-4xl">üì¶</span>
            </div>
        </div>
    </div>

    <header class="h-20 bg-slate-900/50 border-b border-slate-800 flex justify-between items-center px-6 z-50 backdrop-blur-md">
        <div class="flex items-center gap-6">
            <div class="flex flex-col">
                <span class="text-[10px] text-slate-500 uppercase font-bold tracking-tighter">–ó—Ä–∏—Ç–µ–ª–∏ —Å–µ–π—á–∞—Å</span>
                <div class="flex items-center gap-2">
                    <span class="w-2 h-2 bg-red-500 rounded-full animate-pulse"></span>
                    <span id="viewers-count" class="text-xl font-bold">0</span>
                </div>
            </div>
            <div class="h-8 w-px bg-slate-800"></div>
            <div class="flex flex-col">
                <span class="text-[10px] text-orange-400 uppercase font-bold tracking-tighter">–ë–∞–ª–∞–Ω—Å –î–æ–Ω–∞—Ç–æ–≤</span>
                <div class="flex items-center gap-2">
                    <span class="text-xl font-bold text-orange-500"><span id="rubles-count">0</span> ‚ÇΩ</span>
                </div>
            </div>
            <div class="h-8 w-px bg-slate-800"></div>
            <div class="flex flex-col">
                <span class="text-[10px] text-slate-500 uppercase font-bold tracking-tighter">–£—Ä–æ–≤–µ–Ω—å –•–∞–π–ø–∞</span>
                <div class="flex items-center gap-3">
                    <span id="hype-level" class="text-sm font-bold text-purple-400">LVL 1</span>
                    <div class="w-32 bg-slate-800 h-2 rounded-full overflow-hidden border border-slate-700">
                        <div id="hype-progress" class="progress-bar bg-purple-500 h-full w-0 shadow-[0_0_10px_#a855f7]"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="flex gap-3">
            <button onclick="toggleMusic()" id="music-toggle" class="w-10 h-10 flex items-center justify-center bg-slate-800/50 rounded-lg border border-slate-700 hover:border-purple-500 transition-all">üîá</button>
        </div>
    </header>

    <main class="flex-1 flex overflow-hidden">
        <!-- –õ–µ–≤–∞—è —á–∞—Å—Ç—å: –ö–ª–∏–∫–µ—Ä -->
        <div class="flex-1 flex flex-col items-center justify-center p-6 bg-[#020617] relative">
            <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] bg-purple-900/10 blur-[120px] rounded-full"></div>
            
            <button id="minigame-trigger" onclick="startMinigame()" class="hidden absolute top-10 bg-yellow-500 hover:bg-yellow-400 text-black font-black px-6 py-3 rounded-full shadow-[0_0_30px_rgba(234,179,8,0.4)] animate-bounce z-20">
                üì¶ –ü–û–ú–û–ß–¨ –° –ü–ï–†–ï–ï–ó–î–û–ú!
            </button>

            <div id="main-character" class="cursor-pointer click-btn relative z-10 transition-transform">
                <div class="glow-effect"></div>
                <div class="avatar-container">
                    <img src="https://avatars.mds.yandex.net/i?id=0044f68bd780d4447cd7cbbe0d361d9640f61828-9154878-images-thumbs&n=13" 
                         alt="Mazellov" 
                         class="avatar-img"
                         id="avatar">
                    <div id="cooldown-overlay" class="absolute inset-0 flex flex-col items-center justify-center bg-black/60 rounded-full opacity-0 transition-opacity">
                        <span class="text-white font-black text-lg italic tracking-widest">CD</span>
                        <div class="w-12 h-1 bg-purple-500 mt-1 animate-pulse"></div>
                    </div>
                </div>
            </div>

            <div class="mt-8 text-center z-10">
                <p id="character-status" class="text-purple-400 text-xs font-bold tracking-widest uppercase mb-1">–ù–∞—á–∏–Ω–∞—é—â–∏–π —Å—Ç—Ä–∏–º–µ—Ä</p>
                <p class="text-slate-400 text-[10px] font-bold tracking-widest uppercase opacity-50">–ö–ª–∏–∫–∞–π, —á—Ç–æ–±—ã –ø–æ–¥–Ω—è—Ç—å –æ–Ω–ª–∞–π–Ω</p>
                <div class="mt-4 flex gap-4">
                    <div class="bg-slate-900/80 border border-slate-800 px-6 py-2 rounded-xl">
                        <span class="block text-[10px] text-slate-500 uppercase font-bold">–°–∏–ª–∞ –∫–ª–∏–∫–∞</span>
                        <span id="stat-click" class="text-purple-400 font-bold">1</span>
                    </div>
                    <div class="bg-slate-900/80 border border-slate-800 px-6 py-2 rounded-xl">
                        <span class="block text-[10px] text-slate-500 uppercase font-bold">–ê–≤—Ç–æ-–æ–Ω–ª–∞–π–Ω</span>
                        <span id="stat-auto" class="text-blue-400 font-bold">0</span>
                    </div>
                    <div id="boost-indicator" class="hidden bg-orange-500/20 border border-orange-500 px-6 py-2 rounded-xl">
                        <span class="block text-[10px] text-orange-500 uppercase font-bold">–ë–£–°–¢ X2</span>
                        <span id="boost-timer" class="text-orange-400 font-bold text-xs">00:00</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å: –°–∞–π–¥–±–∞—Ä -->
        <div id="sidebar" class="w-96 bg-slate-900/30 border-l border-slate-800 flex flex-col backdrop-blur-xl">
            <div class="grid grid-cols-2 border-b border-slate-800">
                <button onclick="switchTab('upgrades')" id="tab-upgrades" class="tab-btn py-4 text-[10px] font-black uppercase tracking-widest border-b-2 border-transparent transition-all active">–°—Ç—Ä–∏–º</button>
                <button onclick="switchTab('boosts')" id="tab-boosts" class="tab-btn py-4 text-[10px] font-black uppercase tracking-widest border-b-2 border-transparent transition-all">–ë—É—Å—Ç—ã</button>
            </div>

            <div id="content-upgrades" class="flex-1 flex flex-col overflow-hidden">
                <div class="p-4 border-b border-slate-800 bg-slate-950/20">
                    <label class="text-[9px] font-black text-slate-500 uppercase tracking-widest block mb-2">–ü—Ä–æ–º–æ–∫–æ–¥</label>
                    <div class="flex gap-2">
                        <input type="text" id="promo-input" placeholder="–ö–æ–¥..." class="flex-1 bg-slate-950 border border-slate-800 rounded-lg px-3 py-1.5 text-xs outline-none focus:border-purple-500 transition-colors">
                        <button onclick="checkPromo()" class="bg-purple-600 hover:bg-purple-500 px-3 py-1.5 rounded-lg text-xs font-bold transition-all">OK</button>
                    </div>
                </div>
                <div class="flex-1 overflow-y-auto p-4 space-y-3">
                    <div id="shop-list" class="space-y-3"></div>
                </div>
            </div>

            <div id="content-boosts" class="hidden flex-1 flex flex-col overflow-hidden">
                <div class="p-4 border-b border-slate-800 bg-orange-950/10">
                    <p class="text-[10px] text-orange-400 font-bold leading-relaxed uppercase italic">–ú–∞–≥–∞–∑–∏–Ω –∑–∞ –¥–æ–Ω–∞—Ç—ã</p>
                </div>
                <div class="flex-1 overflow-y-auto p-4 space-y-3">
                    <div id="boost-shop-list" class="space-y-3"></div>
                </div>
            </div>
            
            <!-- –ù–∞–¥–ø–∏—Å—å —Å –≤–µ—Ä—Å–∏–µ–π —É–¥–∞–ª–µ–Ω–∞ –ø–æ –∑–∞–ø—Ä–æ—Å—É -->
        </div>
    </main>

    <div id="toast" class="fixed bottom-10 left-1/2 -translate-x-1/2 bg-white text-black px-8 py-3 rounded-2xl font-bold opacity-0 transition-all pointer-events-none z-[1100] shadow-2xl flex items-center gap-3 scale-90">
        <span id="toast-icon">‚ú®</span>
        <span id="toast-text">–£—Å–ø–µ—Ö!</span>
    </div>

    <script>
        // --- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–æ–Ω–∞—Ç–æ–≤ ---
        const donorNames = ["–ü—è—Ç–µ—Ä–∫–∞", "–î—Ä–µ–π–∫", "–®–µ—Ñ", "–•–µ—Å—É—Å", "–ë—Ä–∞—Ç–∏—à–∫–∏–Ω", "–ë—É—Å—Ç–µ—Ä", "–ì–≤–∏–Ω", "–ú–µ–ª—Å—Ç—Ä–æ–π", "–ó—Ä–∏—Ç–µ–ª—å_99", "–ê–Ω–æ–Ω–∏–º", "–°—Ç–∞—Ä—ã–π –¥—Ä—É–≥"];
        const donorMessages = [
            "–ù–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ –∫–∞–Ω–∞–ª–∞!", "–£–¥–∞—á–∏ —Å –ø–µ—Ä–µ–µ–∑–¥–æ–º!", "–ò–ª—å—è, —Ç—ã –ª—É—á—à–∏–π!", "–ó–∞ –ê–π–∑–µ–∫–∞!", "–ü—Ä–æ—Å—Ç–æ —Ç–∞–∫, –±—Ä–æ", "–ù–∞ –î–æ–¥—Å—Ç–µ—Ä", "–ö–æ–≥–¥–∞ —Å—Ç—Ä–∏–º –ø–æ –î–ë–î?", "–ü–æ–±—Ä–µ–π—Å—è –Ω–∞–ª—ã—Å–æ!", "–ü—Ä–∏–≤–µ—Ç –∏–∑ —á–∞—Ç–∞!", "–õ—É—á—à–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç!", "–û—Å—É–∂–¥–∞—é, –Ω–æ –¥–µ—Ä–∂–∏"
        ];

        // --- –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã ---
        let viewers = 0;
        let rubles = 0;
        let totalRubles = 0;
        let clickPower = 1;
        let autoViewers = 0;
        let hypeThreshold = 100;
        let currentHype = 0;
        let level = 1;
        let isMusicPlaying = false;
        let onCooldown = false;
        const COOLDOWN_TIME = 400;

        let activeBoostMultiplier = 1;
        let boostEndTime = 0;

        let isMinigameActive = false;
        let itemsToCollect = 0;

        // --- –≠–≤–æ–ª—é—Ü–∏—è ---
        const evolutionStages = [
            { level: 0, status: "–ù–æ–≤–∏—á–æ–∫", img: "https://avatars.mds.yandex.net/i?id=0044f68bd780d4447cd7cbbe0d361d9640f61828-9154878-images-thumbs&n=13" },
            { level: 20, status: "–£–¥–∏–≤–ª–µ–Ω–Ω—ã–π –ò–ª—å—è", img: "https://avatars.mds.yandex.net/i?id=468d8d83f35cf9b8c932e628595aa7e2cd3d3539-4825378-images-thumbs&n=13" },
            { level: 40, status: "–°–µ—Ä—å–µ–∑–Ω—ã–π –°—Ç—Ä–∏–º–µ—Ä", img: "https://avatars.mds.yandex.net/i?id=fd77adf1146c22fdf77bc062599ef82926a2b5eb-10896978-images-thumbs&n=13" },
            { level: 60, status: "–•–∞–π–ø–æ–≤—ã–π –ú–∞–∑–µ–ª–æ–≤", img: "https://avatars.mds.yandex.net/i?id=25539a39c94ad594e840b9bdf92b5b8a8a0c6a7b-4120677-images-thumbs&n=13" },
            { level: 80, status: "–ó–≤–µ–∑–¥–∞ Twitch", img: "https://avatars.mds.yandex.net/get-entity_search/2114271/1230453077/SUx182_2x" }
        ];

        const upgrades = [
            { id: 'mic', name: '–ú–∏–∫—Ä–æ—Ñ–æ–Ω Fifine', desc: '+1 –∫ –∫–ª–∏–∫—É', cost: 15, power: 1, type: 'click', img: 'https://avatars.mds.yandex.net/get-mpic/15300889/2a0000019686653154ef0e69295a9ed5a7a4/orig' },
            { id: 'chat', name: '–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä —á–∞—Ç–∞', desc: '+1 –∑—Ä–∏—Ç/—Å–µ–∫', cost: 100, power: 1, type: 'auto', img: 'https://avatars.mds.yandex.net/i?id=4d81bcab882f2018cdd662f230207652e7eb19f1-4669930-images-thumbs&n=13' },
            { id: 'cam', name: '–í–µ–±-–∫–∞–º–µ—Ä–∞', desc: '+5 –∫ –∫–ª–∏–∫—É', cost: 500, power: 5, type: 'click', img: 'https://avatars.mds.yandex.net/i?id=e97813f7bdef1d583e7b35ea3d10f54a6666b46c-9856775-images-thumbs&n=13' },
            { id: 'jackbox', name: '–ü–æ–∏–≥—Ä–∞—Ç—å –≤ –î–∂–µ–∫–±–æ–∫—Å', desc: '+10 –∑—Ä–∏—Ç/—Å–µ–∫', cost: 1000, power: 10, type: 'auto', img: 'https://avatars.mds.yandex.net/i?id=3eb513c1c76e511b5ffa49924e7d4aa981b4c4dc-5466682-images-thumbs&n=13' },
            { id: 'isaac', name: '–ü–æ–∏–≥—Ä–∞—Ç—å –≤ –ê–π–∑–µ–∫–∞', desc: '+12 –∫ –∫–ª–∏–∫—É', cost: 2500, power: 12, type: 'click', img: 'https://avatars.mds.yandex.net/i?id=61a36ff26d3b84a40547af82afb4634ac6e441a9-12372285-images-thumbs&n=13' },
            { id: 'reid', name: '–†–µ–π–¥ —Å—Ç—Ä–∏–º–µ—Ä–æ–≤', desc: '+15 –∑—Ä–∏—Ç/—Å–µ–∫', cost: 5000, power: 15, type: 'auto', img: 'https://www.dropbox.com/scl/fi/va0gef5glicihg1ysp76c/137_20260117175356.jpg?rlkey=kieh2dzfcmr28q68z8okjfwzm&st=0rrjgigv&dl=1' },
            { id: 'dbd', name: '–ü–æ–∏–≥—Ä–∞—Ç—å –≤ –î–ë–î', desc: '+40 –∑—Ä–∏—Ç/—Å–µ–∫', cost: 12000, power: 40, type: 'auto', img: 'https://www.dropbox.com/scl/fi/a8wl5lga2ud5uludylqzw/137_20260117181217.jpg?rlkey=icjxya1fi4o5pluu6k4uxqrjq&st=30id8avd&dl=1' },
            { id: 'dodster', name: '–î–æ–¥—Å—Ç–µ—Ä', desc: '+120 –∫ –∫–ª–∏–∫—É', cost: 25000, power: 120, type: 'click', img: 'https://avatars.mds.yandex.net/i?id=b1927f7f92a8bcc8589c37d437faa988853dadcc-8271622-images-thumbs&n=13' },
            { id: 'repo', name: 'R.E.P.O.', desc: '+250 –∫ –∫–ª–∏–∫—É', cost: 60000, power: 250, type: 'click', img: 'https://www.dropbox.com/scl/fi/tsqlohxnz7fzp9mkkcenx/137_20260117181201.jpg?rlkey=mf0rolk3d2dm74mdxfz7sh57k&st=rwl38eke&dl=1' },
            { id: 'pc', name: '–ò–≥—Ä–æ–≤–æ–π –ü–ö', desc: '+500 –∫ –∫–ª–∏–∫—É', cost: 150000, power: 500, type: 'click', img: 'https://power-art.ru/wa-data/public/shop/products/38/22/32238/images/81636/81636.970.png' },
            { id: 'studio', name: '–°–≤–æ—è —Å—Ç—É–¥–∏—è', desc: '+250 –∑—Ä–∏—Ç/—Å–µ–∫', cost: 350000, power: 250, type: 'auto', img: 'https://avatars.mds.yandex.net/i?id=f4eb8d160c3420b513bde12b90f27bb0c6ae63eb-10091199-images-thumbs&n=13' }
        ];

        const boostItems = [
            { id: 'x2_1min', name: '–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫ Flash', desc: 'X2 –∫–ª–∏–∫ –Ω–∞ 60 —Å–µ–∫', cost: 500, duration: 60, multiplier: 2 },
            { id: 'x3_2min', name: '–ö–æ—Ñ–µ –æ—Ç –ü—è—Ç–µ—Ä–∫–∏', desc: 'X3 –∫–ª–∏–∫ –Ω–∞ 120 —Å–µ–∫', cost: 1500, duration: 120, multiplier: 3 },
            { id: 'perm_x1_1', name: '–ó–æ–ª–æ—Ç–∞—è –ø–æ–¥–ø–∏—Å–∫–∞', desc: '+20% –∫ –¥–æ—Ö–æ–¥–∞–º (–Ω–∞–≤—Å–µ–≥–¥–∞)', cost: 10000, multiplier: 1.2, permanent: true }
        ];

        let upgradesOwned = {};
        let boostsOwned = {};
        let promos = {
            'MAZELLOV': { type: 'viewers', reward: 1000, used: false, msg: "–ú–ê–ó–ï–õ–û–í –î–ê–õ 1000 –ó–†–ò–¢–ï–õ–ï–ô!" },
            '5': { type: 'viewers', reward: 5555, used: false, msg: "–ü–Ø–¢–ï–†–ö–ê –ó–ê–õ–ï–¢–ï–õ –ù–ê –°–¢–†–ò–ú!" },
            'SHAVE': { type: 'viewers', reward: 50000, used: false, msg: "–ò–õ–¨–Ø –ü–û–ë–†–ò–õ–°–Ø –ù–ê–õ–´–°–û!" },
            'MZLFF': { type: 'viewers', reward: 500, used: false, msg: "–ü–†–û–ú–û–ö–û–î MZLFF: +500 –ó–†–ò–¢–ï–õ–ï–ô!" },
            '20': { type: 'level', target: 20, used: false, msg: "–£–†–û–í–ï–ù–¨ –•–ê–ô–ü–ê 20 –£–°–¢–ê–ù–û–í–õ–ï–ù!" },
            '40': { type: 'level', target: 40, used: false, msg: "–£–†–û–í–ï–ù–¨ –•–ê–ô–ü–ê 40 –£–°–¢–ê–ù–û–í–õ–ï–ù!" },
            '60': { type: 'level', target: 60, used: false, msg: "–£–†–û–í–ï–ù–¨ –•–ê–ô–ü–ê 60 –£–°–¢–ê–ù–û–í–õ–ï–ù!" },
            '80': { type: 'level', target: 80, used: false, msg: "–£–†–û–í–ï–ù–¨ –•–ê–ô–ü–ê 80 –£–°–¢–ê–ù–û–í–õ–ï–ù!" }
        };

        const viewersEl = document.getElementById('viewers-count');
        const rublesEl = document.getElementById('rubles-count');
        const avatar = document.getElementById('avatar');
        const shopList = document.getElementById('shop-list');
        const boostShopList = document.getElementById('boost-shop-list');
        const hypeProgress = document.getElementById('hype-progress');
        const hypeLevelEl = document.getElementById('hype-level');
        const bgMusic = document.getElementById('bg-music');
        const musicBtn = document.getElementById('music-toggle');
        const statusEl = document.getElementById('character-status');

        function saveGame() {
            const gameState = { viewers, rubles, totalRubles, clickPower, autoViewers, hypeThreshold, currentHype, level, upgradesOwned, boostsOwned, promos };
            localStorage.setItem('mazellov_clicker_v3_6', JSON.stringify(gameState));
        }

        function loadGame() {
            const saved = localStorage.getItem('mazellov_clicker_v3_6');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    if (data.viewers !== undefined) viewers = data.viewers;
                    if (data.rubles !== undefined) rubles = data.rubles;
                    if (data.clickPower !== undefined) clickPower = data.clickPower;
                    if (data.autoViewers !== undefined) autoViewers = data.autoViewers;
                    if (data.hypeThreshold !== undefined) hypeThreshold = data.hypeThreshold;
                    if (data.currentHype !== undefined) currentHype = data.currentHype;
                    if (data.level !== undefined) level = data.level;
                    if (data.upgradesOwned) upgradesOwned = data.upgradesOwned;
                    if (data.boostsOwned) boostsOwned = data.boostsOwned;
                    if (data.promos) promos = data.promos;
                } catch (e) { console.error(e); }
            }
        }

        function formatNumber(num) {
            if (num >= 1e9) return (num / 1e9).toFixed(1) + ' B';
            if (num >= 1e6) return (num / 1e6).toFixed(1) + ' M';
            if (num >= 1e3) return (num / 1e3).toFixed(1) + ' K';
            return Math.floor(num).toLocaleString();
        }

        function showToast(msg, icon = '‚ú®') {
            const toast = document.getElementById('toast');
            document.getElementById('toast-text').innerText = msg;
            document.getElementById('toast-icon').innerText = icon;
            toast.classList.add('opacity-100', 'translate-y-[-20px]', 'scale-100');
            toast.classList.remove('opacity-0', 'scale-90');
            setTimeout(() => {
                toast.classList.remove('opacity-100', 'translate-y-[-20px]', 'scale-100');
                toast.classList.add('opacity-0', 'scale-90');
            }, 3000);
        }

        function setLevel(target) {
            level = target;
            currentHype = 0;
            let baseThreshold = 100;
            for(let i = 1; i < level; i++) {
                baseThreshold = Math.floor(baseThreshold * 1.8);
            }
            hypeThreshold = baseThreshold;
        }

        function checkPromo() {
            const input = document.getElementById('promo-input');
            const code = input.value.toUpperCase().trim();
            if (promos[code]) {
                if (!promos[code].used) {
                    if (promos[code].type === 'viewers') {
                        viewers += promos[code].reward;
                        currentHype += promos[code].reward;
                    } else if (promos[code].type === 'level') {
                        setLevel(promos[code].target);
                    }
                    
                    promos[code].used = true;
                    showToast(promos[code].msg, 'üéÅ');
                    input.value = '';
                    
                    while (currentHype >= hypeThreshold) {
                        currentHype -= hypeThreshold;
                        level++;
                        hypeThreshold = Math.floor(hypeThreshold * 1.8);
                    }
                    
                    updateUI();
                    saveGame();
                } else {
                    showToast("–ü–†–û–ú–û–ö–û–î –£–ñ–ï –ò–°–ü–û–õ–¨–ó–û–í–ê–ù", '‚ùå');
                }
            } else {
                showToast("–ù–ï–í–ï–†–ù–´–ô –ü–†–û–ú–û–ö–û–î", '‚ùì');
            }
        }

        function updateUI() {
            viewersEl.innerText = formatNumber(viewers);
            rublesEl.innerText = formatNumber(rubles);
            const progress = (currentHype / hypeThreshold) * 100;
            hypeProgress.style.width = Math.min(progress, 100) + '%';
            hypeLevelEl.innerText = 'LVL ' + level;
            
            let currentStage = evolutionStages[0];
            for (let stage of evolutionStages) {
                if (level >= stage.level) {
                    currentStage = stage;
                }
            }
            if (avatar.src !== currentStage.img) {
                avatar.src = currentStage.img;
                statusEl.innerText = currentStage.status;
                showToast(`–≠–í–û–õ–Æ–¶–ò–Ø: ${currentStage.status}`, 'üåü');
            }

            let permMult = 1;
            Object.keys(boostsOwned).forEach(id => {
                const item = boostItems.find(b => b.id === id);
                if (item.permanent) permMult *= (1 + (item.multiplier - 1) * boostsOwned[id]);
            });

            const currentPower = clickPower * activeBoostMultiplier * permMult;
            document.getElementById('stat-click').innerText = '+' + formatNumber(currentPower);
            document.getElementById('stat-auto').innerText = formatNumber(autoViewers * permMult) + '/s';

            const boostIndicator = document.getElementById('boost-indicator');
            if (activeBoostMultiplier > 1 && Date.now() < boostEndTime) {
                boostIndicator.classList.remove('hidden');
                const timeLeft = Math.max(0, Math.floor((boostEndTime - Date.now()) / 1000));
                document.getElementById('boost-timer').innerText = `00:${timeLeft.toString().padStart(2, '0')}`;
            } else {
                activeBoostMultiplier = 1;
                boostIndicator.classList.add('hidden');
            }

            upgrades.forEach(upg => {
                const btn = document.getElementById('btn-' + upg.id);
                if (btn) {
                    const count = upgradesOwned[upg.id] || 0;
                    const cost = Math.floor(upg.cost * Math.pow(1.35, count));
                    btn.querySelector('.cost').innerText = formatNumber(cost);
                    btn.querySelector('.count').innerText = count;
                    btn.disabled = viewers < cost;
                    btn.style.opacity = viewers < cost ? '0.4' : '1';
                }
            });
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('tab-' + tab).classList.add('active');
            document.getElementById('content-upgrades').classList.toggle('hidden', tab !== 'upgrades');
            document.getElementById('content-boosts').classList.toggle('hidden', tab !== 'boosts');
        }

        function startMinigame() {
            document.getElementById('minigame-trigger').classList.add('hidden');
            isMinigameActive = true;
            const screen = document.getElementById('minigame-screen');
            const area = document.getElementById('game-area');
            const timerEl = document.getElementById('minigame-timer');
            screen.style.display = 'flex';
            
            area.querySelectorAll('.game-item').forEach(i => i.remove());
            
            const itemEmojis = ['üé∏', 'üíª', 'üß•', 'üçî', 'üï∂Ô∏è', 'üé§', 'üìö', 'üß∏'];
            itemsToCollect = 8;
            
            for (let i = 0; i < itemsToCollect; i++) {
                const item = document.createElement('div');
                item.className = 'game-item';
                item.innerText = itemEmojis[i % itemEmojis.length];
                item.style.left = (Math.random() * 80 + 10) + '%';
                item.style.top = (Math.random() * 60 + 20) + '%';
                item.onclick = (e) => {
                    e.stopPropagation();
                    item.style.transition = 'all 0.4s';
                    item.style.left = '50%';
                    item.style.top = '25%';
                    item.style.opacity = '0';
                    item.style.pointerEvents = 'none';
                    itemsToCollect--;
                    if (itemsToCollect === 0) finishMinigame(true);
                };
                area.appendChild(item);
            }

            let timeLeft = 10.0;
            const timerInterval = setInterval(() => {
                timeLeft -= 0.1;
                timerEl.innerText = timeLeft.toFixed(1);
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    if (itemsToCollect > 0) finishMinigame(false);
                }
                if (itemsToCollect === 0) {
                    clearInterval(timerInterval);
                }
            }, 100);
        }

        function finishMinigame(win) {
            isMinigameActive = false;
            const screen = document.getElementById('minigame-screen');
            screen.style.display = 'none';
            if (win) {
                activeBoostMultiplier = 2;
                boostEndTime = Date.now() + 20000;
                showToast("–ü–ï–†–ï–ï–ó–î –£–°–ü–ï–®–ï–ù! –ë–£–°–¢ X2 –ù–ê 20 –°–ï–ö", 'üì¶');
            } else {
                showToast("–ù–ï –£–°–ü–ï–õ –°–û–ë–†–ê–¢–¨ –í–ï–©–ò...", '‚ùå');
            }
            updateUI();
        }

        document.getElementById('main-character').addEventListener('mousedown', (e) => {
            if (onCooldown) return;
            let permMult = 1;
            Object.keys(boostsOwned).forEach(id => {
                const item = boostItems.find(b => b.id === id);
                if (item.permanent) permMult *= (1 + (item.multiplier - 1) * boostsOwned[id]);
            });

            const power = clickPower * activeBoostMultiplier * permMult;
            viewers += power;
            currentHype += power;
            
            const el = document.createElement('div');
            el.className = 'floating-text text-purple-400';
            el.style.left = e.clientX + 'px'; el.style.top = e.clientY + 'px';
            el.innerText = '+' + formatNumber(power);
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 800);

            while (currentHype >= hypeThreshold) {
                currentHype -= hypeThreshold;
                level++;
                hypeThreshold = Math.floor(hypeThreshold * 1.8);
                showToast(`LVL UP: ${level}`, 'üî•');
            }

            onCooldown = true;
            avatar.classList.add('cooldown');
            document.getElementById('cooldown-overlay').style.opacity = '1';
            setTimeout(() => {
                onCooldown = false;
                avatar.classList.remove('cooldown');
                document.getElementById('cooldown-overlay').style.opacity = '0';
            }, COOLDOWN_TIME);
            updateUI();
        });

        function buyUpgrade(id) {
            const upg = upgrades.find(u => u.id === id);
            const count = upgradesOwned[id] || 0;
            const cost = Math.floor(upg.cost * Math.pow(1.35, count));
            if (viewers >= cost) {
                viewers -= cost;
                upgradesOwned[id] = count + 1;
                if (upg.type === 'click') clickPower += upg.power;
                if (upg.type === 'auto') autoViewers += upg.power;
                updateUI();
                saveGame();
            }
        }

        function triggerDonation() {
            const amount = Math.floor(100 + Math.random() * 2000);
            const randomName = donorNames[Math.floor(Math.random() * donorNames.length)];
            const randomMsg = donorMessages[Math.floor(Math.random() * donorMessages.length)];
            
            const alert = document.getElementById('da-alert');
            document.getElementById('da-user').innerText = randomName;
            document.getElementById('da-msg').innerText = `"${randomMsg}"`;
            document.getElementById('da-amount').innerText = `${amount} ‚ÇΩ`;
            
            alert.classList.add('active');
            rubles += amount;
            setTimeout(() => { alert.classList.remove('active'); updateUI(); saveGame(); }, 4000);
        }

        function toggleMusic() {
            if (isMusicPlaying) { bgMusic.pause(); musicBtn.innerText = 'üîá'; }
            else { bgMusic.play(); musicBtn.innerText = 'üîä'; }
            isMusicPlaying = !isMusicPlaying;
        }

        window.onload = () => {
            loadGame();
            upgrades.sort((a,b)=>a.cost-b.cost).forEach(upg => {
                const btn = document.createElement('button');
                btn.id = 'btn-' + upg.id;
                btn.className = 'w-full text-left p-4 bg-slate-800/30 border border-slate-700/50 rounded-xl hover:bg-slate-800 flex items-center gap-4';
                btn.innerHTML = `<img src="${upg.img}" class="upgrade-icon"><div><div class="font-bold text-[11px]">${upg.name}</div><div class="text-[8px] text-slate-500 uppercase">${upg.desc}</div></div><div class="ml-auto text-right"><div class="text-white font-bold text-xs"><span class="cost"></span> üëÅÔ∏è</div><div class="text-[8px] text-slate-500 uppercase">Lvl <span class="count"></span></div></div>`;
                btn.onclick = () => buyUpgrade(upg.id);
                shopList.appendChild(btn);
            });

            boostItems.forEach(item => {
                const btn = document.createElement('button');
                btn.id = 'boost-btn-' + item.id;
                btn.className = 'w-full text-left p-4 bg-orange-950/10 border border-orange-500/20 rounded-xl hover:bg-orange-500/20 flex items-center gap-4';
                btn.innerHTML = `<div class="text-2xl">${item.permanent ? 'üëë' : '‚ö°'}</div><div class="flex-1"><div class="font-bold text-[11px]">${item.name}</div><div class="text-[8px] text-orange-400 uppercase">${item.desc}</div></div><div class="text-orange-400 font-black text-xs">${item.cost} ‚ÇΩ</div>`;
                btn.onclick = () => {
                    if (rubles >= item.cost) {
                        rubles -= item.cost;
                        if (item.permanent) { boostsOwned[item.id] = (boostsOwned[item.id] || 0) + 1; }
                        else { activeBoostMultiplier = item.multiplier; boostEndTime = Date.now() + (item.duration * 1000); }
                        updateUI(); saveGame();
                    }
                };
                boostShopList.appendChild(btn);
            });

            setInterval(() => {
                if (autoViewers > 0) {
                    let permMult = 1;
                    Object.keys(boostsOwned).forEach(id => {
                        const i = boostItems.find(b => b.id === id);
                        if (i.permanent) permMult *= (1 + (i.multiplier - 1) * boostsOwned[id]);
                    });
                    
                    const tickValue = (autoViewers * permMult) / 10;
                    viewers += tickValue;
                    currentHype += tickValue;
                    
                    while (currentHype >= hypeThreshold) {
                        currentHype -= hypeThreshold;
                        level++;
                        hypeThreshold = Math.floor(hypeThreshold * 1.8);
                    }
                }
                updateUI();
            }, 100);

            setInterval(() => { if (Math.random() > 0.9) triggerDonation(); }, 7000);
            
            setInterval(() => {
                if (Math.random() > 0.7 && !isMinigameActive) {
                    document.getElementById('minigame-trigger').classList.remove('hidden');
                }
            }, 15000);

            updateUI();
        };
    </script>
</body>
</html>
