<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mzlff Clicker BETA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Unbounded', sans-serif;
            background-color: #020617;
            color: #f8fafc;
            overflow: hidden;
            margin: 0;
            height: 100vh;
        }
        .click-btn:active {
            transform: scale(0.95);
        }
        .cooldown {
            filter: grayscale(1) blur(2px);
            pointer-events: none;
        }
        .floating-text {
            position: absolute;
            pointer-events: none;
            animation: floatUp 0.8s ease-out forwards;
            font-weight: 800;
            z-index: 100;
            text-shadow: 0 0 10px rgba(168, 85, 247, 0.5);
        }
        @keyframes floatUp {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-120px) scale(1.2); opacity: 0; }
        }
        .progress-bar {
            transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .avatar-container {
            position: relative;
            width: 220px;
            height: 220px;
        }
        .avatar-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
            border: 4px solid #a855f7;
            box-shadow: 0 0 30px rgba(168, 85, 247, 0.4);
            transition: all 0.2s ease;
        }
        .glow-effect {
            position: absolute;
            inset: -10px;
            background: radial-gradient(circle, rgba(168, 85, 247, 0.2) 0%, transparent 70%);
            border-radius: 50%;
            z-index: -1;
        }
        .upgrade-icon {
            width: 52px;
            height: 52px;
            border-radius: 10px;
            object-fit: cover;
            border: 2px solid #334155;
            background: #1e293b;
        }
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #a855f7;
        }
    </style>
</head>
<body class="flex flex-col h-screen overflow-hidden">

    <audio id="bg-music" loop>
        <source src="https://www.dropbox.com/scl/fi/th9kidjdf1blqezgqlpcz/.mp3?rlkey=59a6wz4w09v35noavrwbiy081&st=zel497ne&dl=1" type="audio/mpeg">
    </audio>

    <header class="h-16 bg-slate-900/50 border-b border-slate-800 flex justify-between items-center px-6 z-50 backdrop-blur-md">
        <div class="flex items-center gap-6">
            <div class="flex flex-col">
                <span class="text-[10px] text-slate-500 uppercase font-bold tracking-tighter">–ó—Ä–∏—Ç–µ–ª–∏ —Å–µ–π—á–∞—Å</span>
                <div class="flex items-center gap-2">
                    <span class="w-2 h-2 bg-red-500 rounded-full animate-pulse"></span>
                    <span id="viewers-count" class="text-xl font-bold">0</span>
                </div>
            </div>
            <div class="h-8 w-px bg-slate-800"></div>
            <div class="flex flex-col">
                <span class="text-[10px] text-slate-500 uppercase font-bold tracking-tighter">–£—Ä–æ–≤–µ–Ω—å –•–∞–π–ø–∞</span>
                <div class="flex items-center gap-3">
                    <span id="hype-level" class="text-sm font-bold text-purple-400">LVL 1</span>
                    <div class="w-32 bg-slate-800 h-2 rounded-full overflow-hidden border border-slate-700">
                        <div id="hype-progress" class="progress-bar bg-purple-500 h-full w-0 shadow-[0_0_10px_#a855f7]"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="flex gap-3">
            <button onclick="toggleMusic()" id="music-toggle" class="w-10 h-10 flex items-center justify-center bg-slate-800/50 rounded-lg border border-slate-700 hover:border-purple-500 transition-all">üîá</button>
        </div>
    </header>

    <main class="flex-1 flex overflow-hidden">
        <div class="flex-1 flex flex-col items-center justify-center p-6 bg-[#020617] relative">
            <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] bg-purple-900/10 blur-[120px] rounded-full"></div>
            
            <div id="main-character" class="cursor-pointer click-btn relative z-10 transition-transform">
                <div class="glow-effect"></div>
                <div class="avatar-container">
                    <img src="https://avatars.mds.yandex.net/i?id=0044f68bd780d4447cd7cbbe0d361d9640f61828-9154878-images-thumbs&n=13" 
                         alt="Mazellov" 
                         class="avatar-img"
                         id="avatar">
                    <div id="cooldown-overlay" class="absolute inset-0 flex flex-col items-center justify-center bg-black/60 rounded-full opacity-0 transition-opacity">
                        <span class="text-white font-black text-lg italic tracking-widest">CD</span>
                        <div class="w-12 h-1 bg-purple-500 mt-1 animate-pulse"></div>
                    </div>
                </div>
            </div>

            <div class="mt-8 text-center z-10">
                <p class="text-slate-400 text-sm font-bold tracking-widest uppercase opacity-50">–ö–ª–∏–∫–∞–π, —á—Ç–æ–±—ã –ø–æ–¥–Ω—è—Ç—å –æ–Ω–ª–∞–π–Ω</p>
                <div class="mt-4 flex gap-4">
                    <div class="bg-slate-900/80 border border-slate-800 px-6 py-2 rounded-xl">
                        <span class="block text-[10px] text-slate-500 uppercase font-bold">–°–∏–ª–∞ –∫–ª–∏–∫–∞</span>
                        <span id="stat-click" class="text-purple-400 font-bold">1</span>
                    </div>
                    <div class="bg-slate-900/80 border border-slate-800 px-6 py-2 rounded-xl">
                        <span class="block text-[10px] text-slate-500 uppercase font-bold">–ê–≤—Ç–æ-–æ–Ω–ª–∞–π–Ω</span>
                        <span id="stat-auto" class="text-blue-400 font-bold">0</span>
                    </div>
                </div>
            </div>
        </div>

        <div id="sidebar" class="w-96 bg-slate-900/30 border-l border-slate-800 flex flex-col backdrop-blur-xl">
            <div class="p-6 border-b border-slate-800">
                <label class="text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-2">–ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–æ–¥–∞</label>
                <div class="flex gap-2">
                    <input type="text" id="promo-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥..." class="flex-1 bg-slate-950 border border-slate-800 rounded-lg px-4 py-2 text-sm outline-none focus:border-purple-500 transition-colors">
                    <button onclick="checkPromo()" class="bg-purple-600 hover:bg-purple-500 px-4 py-2 rounded-lg text-xs font-bold transition-all shadow-lg shadow-purple-900/20">OK</button>
                </div>
            </div>
            
            <div class="flex-1 overflow-y-auto p-6 space-y-4">
                <h2 class="text-xs font-black text-slate-500 uppercase tracking-widest mb-2">–£–ª—É—á—à–µ–Ω–∏—è —Å—Ç—Ä–∏–º–∞</h2>
                <div id="shop-list" class="space-y-3"></div>
            </div>
            
            <div class="p-4 text-center">
                <p class="text-[9px] text-slate-600 uppercase font-bold">Mazellov Clicker v2.8 (Local Save)</p>
            </div>
        </div>
    </main>

    <div id="toast" class="fixed bottom-10 left-1/2 -translate-x-1/2 bg-white text-black px-8 py-3 rounded-2xl font-bold opacity-0 transition-all pointer-events-none z-[100] shadow-2xl flex items-center gap-3 scale-90">
        <span id="toast-icon">‚ú®</span>
        <span id="toast-text">–£—Å–ø–µ—Ö!</span>
    </div>

    <script>
        // --- Game State ---
        let viewers = 0;
        let clickPower = 1;
        let autoViewers = 0;
        let hypeThreshold = 100;
        let currentHype = 0;
        let level = 1;
        let isMusicPlaying = false;
        let onCooldown = false;
        const COOLDOWN_TIME = 400;

        const upgrades = [
            { 
                id: 'mic', 
                name: '–ú–∏–∫—Ä–æ—Ñ–æ–Ω Fifine', 
                desc: '+1 –∫ –∫–ª–∏–∫—É', 
                cost: 15, 
                power: 1, 
                type: 'click',
                img: 'https://avatars.mds.yandex.net/get-mpic/15300889/2a0000019686653154ef0e69295a9ed5a7a4/orig'
            },
            { 
                id: 'chat', 
                name: '–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä —á–∞—Ç–∞', 
                desc: '+1 –∑—Ä–∏—Ç/—Å–µ–∫', 
                cost: 100, 
                power: 1, 
                type: 'auto',
                img: 'https://avatars.mds.yandex.net/i?id=4d81bcab882f2018cdd662f230207652e7eb19f1-4669930-images-thumbs&n=13'
            },
            { 
                id: 'cam', 
                name: '–í–µ–±-–∫–∞–º–µ—Ä–∞', 
                desc: '+5 –∫ –∫–ª–∏–∫—É', 
                cost: 500, 
                power: 5, 
                type: 'click',
                img: 'https://avatars.mds.yandex.net/i?id=e97813f7bdef1d583e7b35ea3d10f54a6666b46c-9856775-images-thumbs&n=13'
            },
            { 
                id: 'isaac', 
                name: '–ü–æ–∏–≥—Ä–∞—Ç—å –≤ –ê–π–∑–µ–∫–∞', 
                desc: '+12 –∫ –∫–ª–∏–∫—É', 
                cost: 1200, 
                power: 12, 
                type: 'click',
                img: 'https://avatars.mds.yandex.net/i?id=61a36ff26d3b84a40547af82afb4634ac6e441a9-12372285-images-thumbs&n=13'
            },
            { 
                id: 'reid', 
                name: '–†–µ–π–¥ —Å—Ç—Ä–∏–º–µ—Ä–æ–≤', 
                desc: '+15 –∑—Ä–∏—Ç/—Å–µ–∫', 
                cost: 2000, 
                power: 15, 
                type: 'auto',
                img: 'https://www.dropbox.com/scl/fi/va0gef5glicihg1ysp76c/137_20260117175356.jpg?rlkey=kieh2dzfcmr28q68z8okjfwzm&st=0rrjgigv&dl=1'
            },
            { 
                id: 'dbd', 
                name: '–ü–æ–∏–≥—Ä–∞—Ç—å –≤ –î–ë–î', 
                desc: '+40 –∑—Ä–∏—Ç/—Å–µ–∫', 
                cost: 8000, 
                power: 40, 
                type: 'auto',
                img: 'https://www.dropbox.com/scl/fi/a8wl5lga2ud5uludylqzw/137_20260117181217.jpg?rlkey=icjxya1fi4o5pluu6k4uxqrjq&st=30id8avd&dl=1'
            },
            { 
                id: 'dodster', 
                name: '–î–æ–¥—Å—Ç–µ—Ä', 
                desc: '+120 –∫ –∫–ª–∏–∫—É', 
                cost: 15000, 
                power: 120, 
                type: 'click',
                img: 'https://avatars.mds.yandex.net/i?id=b1927f7f92a8bcc8589c37d437faa988853dadcc-8271622-images-thumbs&n=13'
            },
            { 
                id: 'repo', 
                name: 'R.E.P.O.', 
                desc: '+250 –∫ –∫–ª–∏–∫—É', 
                cost: 45000, 
                power: 250, 
                type: 'click',
                img: 'https://www.dropbox.com/scl/fi/tsqlohxnz7fzp9mkkcenx/137_20260117181201.jpg?rlkey=mf0rolk3d2dm74mdxfz7sh57k&st=rwl38eke&dl=1'
            },
            { 
                id: 'pc', 
                name: '–ò–≥—Ä–æ–≤–æ–π –ü–ö', 
                desc: '+50 –∫ –∫–ª–∏–∫—É', 
                cost: 75000, 
                power: 50, 
                type: 'click',
                img: 'https://power-art.ru/wa-data/public/shop/products/38/22/32238/images/81636/81636.970.png'
            },
            { 
                id: 'studio', 
                name: '–°–≤–æ—è —Å—Ç—É–¥–∏—è', 
                desc: '+150 –∑—Ä–∏—Ç/—Å–µ–∫', 
                cost: 100000, 
                power: 150, 
                type: 'auto',
                img: 'https://avatars.mds.yandex.net/i?id=f4eb8d160c3420b513bde12b90f27bb0c6ae63eb-10091199-images-thumbs&n=13'
            }
        ];

        let promos = {
            'MAZELLOV': { reward: 1000, used: false, msg: "–ú–ê–ó–ï–õ–û–í –î–ê–õ 1000 –ó–†–ò–¢–ï–õ–ï–ô!" },
            '5': { reward: 5555, used: false, msg: "–ü–Ø–¢–ï–†–ö–ê –ó–ê–õ–ï–¢–ï–õ –ù–ê –°–¢–†–ò–ú!" },
            'SHAVE': { reward: 50000, used: false, msg: "–ò–õ–¨–Ø –ü–û–ë–†–ò–õ–°–Ø –ù–ê–õ–´–°–û!" }
        };

        let upgradesOwned = {};

        const viewersEl = document.getElementById('viewers-count');
        const avatar = document.getElementById('avatar');
        const shopList = document.getElementById('shop-list');
        const hypeProgress = document.getElementById('hype-progress');
        const hypeLevelEl = document.getElementById('hype-level');
        const bgMusic = document.getElementById('bg-music');
        const musicBtn = document.getElementById('music-toggle');

        // --- Persistent Storage Logic ---
        function saveGame() {
            const gameState = {
                viewers,
                clickPower,
                autoViewers,
                hypeThreshold,
                currentHype,
                level,
                upgradesOwned,
                promos
            };
            localStorage.setItem('mazellov_clicker_v2_8', JSON.stringify(gameState));
        }

        function loadGame() {
            const saved = localStorage.getItem('mazellov_clicker_v2_8');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    viewers = data.viewers || 0;
                    clickPower = data.clickPower || 1;
                    autoViewers = data.autoViewers || 0;
                    hypeThreshold = data.hypeThreshold || 100;
                    currentHype = data.currentHype || 0;
                    level = data.level || 1;
                    upgradesOwned = data.upgradesOwned || {};
                    if (data.promos) promos = data.promos;
                } catch (e) {
                    console.error("Failed to load save", e);
                }
            }
        }

        // --- Game Mechanics ---
        function toggleMusic() {
            if (isMusicPlaying) {
                bgMusic.pause(); musicBtn.innerText = 'üîá';
            } else {
                bgMusic.play().catch(e => {
                    showToast("–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —ç–∫—Ä–∞–Ω –¥–ª—è –∑–≤—É–∫–∞", "üéµ");
                }); 
                musicBtn.innerText = 'üîä';
            }
            isMusicPlaying = !isMusicPlaying;
        }

        function formatNumber(num) {
            if (num >= 1e9) return (num / 1e9).toFixed(1) + ' B';
            if (num >= 1e6) return (num / 1e6).toFixed(1) + ' M';
            if (num >= 1e3) return (num / 1e3).toFixed(1) + ' K';
            return Math.floor(num).toLocaleString();
        }

        function showToast(msg, icon = '‚ú®') {
            const toast = document.getElementById('toast');
            document.getElementById('toast-text').innerText = msg;
            document.getElementById('toast-icon').innerText = icon;
            toast.classList.add('opacity-100', 'translate-y-[-20px]', 'scale-100');
            toast.classList.remove('opacity-0', 'scale-90');
            setTimeout(() => {
                toast.classList.remove('opacity-100', 'translate-y-[-20px]', 'scale-100');
                toast.classList.add('opacity-0', 'scale-90');
            }, 3000);
        }

        function updateUI() {
            viewersEl.innerText = formatNumber(viewers);
            const progress = (currentHype / hypeThreshold) * 100;
            hypeProgress.style.width = Math.min(progress, 100) + '%';
            hypeLevelEl.innerText = 'LVL ' + level;
            document.getElementById('stat-click').innerText = '+' + formatNumber(clickPower);
            document.getElementById('stat-auto').innerText = formatNumber(autoViewers) + '/s';

            upgrades.forEach(upg => {
                const btn = document.getElementById('btn-' + upg.id);
                const count = upgradesOwned[upg.id] || 0;
                const cost = Math.floor(upg.cost * Math.pow(1.35, count));
                if (btn) {
                    btn.querySelector('.cost').innerText = formatNumber(cost);
                    btn.querySelector('.count').innerText = count;
                    btn.disabled = viewers < cost;
                    btn.style.opacity = viewers < cost ? '0.4' : '1';
                }
            });
        }

        document.getElementById('main-character').addEventListener('mousedown', (e) => {
            if (onCooldown) return;
            viewers += clickPower;
            currentHype += clickPower;
            
            const el = document.createElement('div');
            el.className = 'floating-text text-purple-400';
            el.style.left = e.clientX + 'px';
            el.style.top = e.clientY + 'px';
            el.innerText = '+' + formatNumber(clickPower);
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 800);

            while (currentHype >= hypeThreshold) {
                currentHype -= hypeThreshold;
                level++;
                hypeThreshold = Math.floor(hypeThreshold * 1.8);
                showToast(`–ù–û–í–´–ô –£–†–û–í–ï–ù–¨ –•–ê–ô–ü–ê: ${level}`, 'üî•');
            }

            onCooldown = true;
            avatar.classList.add('cooldown');
            document.getElementById('cooldown-overlay').style.opacity = '1';
            
            setTimeout(() => {
                onCooldown = false;
                avatar.classList.remove('cooldown');
                document.getElementById('cooldown-overlay').style.opacity = '0';
            }, COOLDOWN_TIME);
            
            updateUI();
            saveGame();
        });

        function buyUpgrade(id) {
            const upg = upgrades.find(u => u.id === id);
            const count = upgradesOwned[id] || 0;
            const cost = Math.floor(upg.cost * Math.pow(1.35, count));
            
            if (viewers >= cost) {
                viewers -= cost;
                upgradesOwned[id] = count + 1;
                if (upg.type === 'click') clickPower += upg.power;
                if (upg.type === 'auto') autoViewers += upg.power;
                updateUI();
                saveGame();
            }
        }

        function checkPromo() {
            const input = document.getElementById('promo-input');
            const code = input.value.toUpperCase().trim();
            if (promos[code]) {
                if (promos[code].used) {
                    showToast("–£–ñ–ï –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–û", '‚ùå');
                } else {
                    viewers += promos[code].reward;
                    currentHype += promos[code].reward;
                    promos[code].used = true;
                    showToast(promos[code].msg, 'üí∞');
                    updateUI();
                    saveGame();
                }
            } else {
                showToast("–ù–ï–í–ï–†–ù–´–ô –ö–û–î", '‚ùì');
            }
            input.value = "";
        }

        window.onload = () => {
            loadGame();
            
            const sortedUpgrades = [...upgrades].sort((a, b) => a.cost - b.cost);
            
            sortedUpgrades.forEach(upg => {
                const btn = document.createElement('button');
                btn.id = 'btn-' + upg.id;
                btn.className = 'w-full text-left p-4 bg-slate-800/50 border border-slate-700 rounded-xl hover:border-purple-500 hover:bg-slate-800 transition-all flex items-center gap-4 outline-none group';
                
                const iconHtml = upg.img ? `<img src="${upg.img}" class="upgrade-icon" alt="${upg.name}">` : `<div class="upgrade-icon bg-slate-700 flex items-center justify-center text-xs">üì¶</div>`;

                btn.innerHTML = `
                    ${iconHtml}
                    <div class="flex-1">
                        <div class="font-bold text-sm group-hover:text-purple-400 transition-colors">${upg.name}</div>
                        <div class="text-[10px] text-slate-500">${upg.desc}</div>
                    </div>
                    <div class="text-right">
                        <div class="text-white font-bold text-sm"><span class="cost">${upg.cost}</span> üëÅÔ∏è</div>
                        <div class="text-[9px] text-slate-500 uppercase font-bold">LVL: <span class="count">0</span></div>
                    </div>
                `;
                btn.onclick = () => buyUpgrade(upg.id);
                shopList.appendChild(btn);
            });

            // Game Loop for Auto-viewers
            setInterval(() => {
                if (autoViewers > 0) {
                    viewers += autoViewers / 10;
                    currentHype += autoViewers / 10;
                    updateUI();
                }
            }, 100);

            // Frequent Auto-save
            setInterval(saveGame, 5000);
            
            updateUI();
        };
    </script>
</body>
</html>
